{% extends "base/base.html" %}

{% block title %} Správa učitelů {% endblock %}


{% block content %}
<h3 class="page-header"><i class="fa fa-database"></i> Správa učitelů</h3>



<script>
jQuery(document).ready(function() {
    jQuery("#button_1").click(function (e) {
        e.preventDefault();
        jQuery.ajax({
            type: "POST",
            url: "/ajax-teacher-delete/",
            data: {
                id: 1,

            },
            success: function (result) {
                console.log(result);
            },
            error: function (result) {
                alert(result);
            }
        });
    })
})
</script>





<div class="row">
  <div class="col-sm-2">

    <a href="{{ url_for("teacher_add") }}" alt="Nový" title="Nový">
    <i class="icon_plus_alt2"></i> Nový učitel
    </a>
  </div>
</div>
    <br>
<div class="row">
  <div class="col-sm-6">
    <table class="table table-bordered table-striped">
      <thead>
        <tr class="warning">
          <th scope="col">#</th>
          <th scope="col">Login</th>
          <th scope="col">Jméno</th>
          <th scope="col">Manager</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
    {% for t in teachers %}
        <tr>
          <th scope="row">{{ loop.index }}</th>
          <td>{{ t.login }}</td>
          <td>{{ t.name }}</td>
          <td>{{ "Ano" if t.manager else "---" }}</td>
          <td nowrap align="center">
{#            <form method="POST" class="link_delete_teacher" action="{{ url_for("teacher_del1") }}">
                  <input type="hidden">
              <button class="link_delete_teacher" alt="Smazat" title="Smazat">
                <i class="icon_trash"></i> Smazat
              </button>
              </form> &nbsp; | &nbsp;
#}
              <a class="link_delete_teacher" data-teacher_id="{{ t.id }}" href="/" alt="Smazat" title="Smazat">
                <i class="icon_trash"></i> Smazat
              </a> &nbsp; | &nbsp;
              <a href="{{ t.id }}" alt="Změnit" title="Změnit">
                <i class="icon_pencil-edit"></i> Změnit
              </a>
          </td>
        </tr>
    {% endfor %}
      </tbody>
    </table>
  </div>

</div>

<script>
    jQuery(".link_delete_teacher").on("click", function(e) {
        var odkaz = jQuery(this);

        e.preventDefault();     // aby se nepouzivala defaultni metoda pro obsluhu clicku
        // e.stopPropagation()  // aby se ta udalost obslouzila jen na tomto elementu a ne (i) na nadrazenych elementech

        jQuery("<div>Opravdu smazat?</div>").dialog({
            buttons: {
                "Ano": function() {
                    //window.location = odkaz.href;
                    jQuery.ajax({
                        type: "POST",
                        url: "/ajax-teacher-delete/",
                        data: {
                            id: odkaz.attr("data-teacher_id")

                        },
                        success: function (result) {
                            //console.log(result);
                            //alert("smazano" + odkaz.href)  // v tuto chvili uz promenna odkaz neexistuje
                            //odkaz.attr("data-teacher_id", 500)   // takto funguje attr() i jako setter
                            window.location.reload()

                        },
                        error: function (result) {
                            //alert("Chyba při mazání učitele.");
                            //chybu nebudeme resit...
                        }
                    });

                    $(this).dialog("close");
                },
                "Ne": function() {
                    $(this).dialog("close");
                }
            }
        });
    });
</script>


{% endblock %}
